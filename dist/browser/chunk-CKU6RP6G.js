import{a as k,b as w}from"./chunk-IVVUZLMP.js";import{d as L}from"./chunk-DOBZLDMO.js";import{Aa as g,Ba as y,Fa as l,Ga as S,Ha as D,N as c,P as _,Qa as C,W as m,X as p,bb as I,ia as f,ka as s,oa as d,ra as b,ua as h,va as x,wa as r,xa as a,ya as v,za as u}from"./chunk-SQOWPWAF.js";import"./chunk-WLMSNEJV.js";var V="Colombia";function F(n,e){if(n&1){let t=u();r(0,"button",4),g("click",function(){m(t);let o=y();return p(o.onClickCountryValid())}),l(1," Continuar "),a()}}function M(n,e){if(n&1){let t=u();r(0,"button",5),g("click",function(){m(t);let o=y();return p(o.onClick())}),l(1," Continuar "),a()}}var T=class n{incodeSDK=c(w);stateBiometricService=c(k);router=c(L);_nameImg=d("location");_title=d("Necesitamos determinar tu ubicaci\xF3n");nameImg=this._nameImg.asReadonly();title=this._title.asReadonly();isColombiaLocation=C(()=>this._title().toLowerCase().includes("colombia"));imagePath=C(()=>`assets/img/${this._nameImg()}.svg`);isDisabled=!0;constructor(){}processGeolocation(e){this.incodeSDK.incode.sendGeolocation({token:e}).then(t=>{if(console.log("Geolocation sent successfully:",t),t.location){this.isDisabled=!1;let i=this.parseLocationString(t.location);this.updateLocationDisplay(i),this.redirectIfInvalidCountry(t.location)}}).catch(t=>{console.error("error",t)})}redirectIfInvalidCountry(e){e.includes(V)||(console.log("INVALID COUNTRY"),this.router.navigate(["/invalid"]))}parseLocationString(e){let t=e.split(","),i=t[1]?.split(" ")[2],o=t[2]?.trim();return{city:i,country:o}}updateLocationDisplay(e){this._title.set(`Actualmente est\xE1 en: ${e.city}, ${e.country}`),this._nameImg.set("location_2")}processFingerprint(e){this.incodeSDK.incode.sendFingerprint({token:e}).catch(t=>{console.log("error",t)})}onClick(){this.isDisabled=!0,this.incodeSDK.createSession().subscribe(e=>{this.processGeolocation(e.token),this.processFingerprint(e.token)})}onClickCountryValid(){this.stateBiometricService.updateStartBiometric(!0),this.router.navigate(["/suggestion"])}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=_({type:n,selectors:[["app-location"]],standalone:!0,features:[D],decls:6,vars:4,consts:[[1,"container"],[3,"src","alt"],["type","button",1,"btn-primary"],["type","button","aria-label","Determinar ubicaci\xF3n",1,"btn-primary"],["type","button",1,"btn-primary",3,"click"],["type","button","aria-label","Determinar ubicaci\xF3n",1,"btn-primary",3,"click"]],template:function(t,i){t&1&&(r(0,"section",0),v(1,"img",1),r(2,"h1"),l(3),a(),b(4,F,2,0,"button",2)(5,M,2,0,"button",3),a()),t&2&&(s(),h("src",i.imagePath(),f)("alt",i.nameImg()),s(2),S(i.title()),s(),x(i.isColombiaLocation()?4:5))},dependencies:[I],styles:["button[_ngcontent-%COMP%]{width:158px;font-size:20px}.container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center}h1[_ngcontent-%COMP%]{font-family:Gilroy-Bold,sans-serif;font-size:25px;font-weight:400;text-align:center;padding-bottom:84px}img[_ngcontent-%COMP%]{height:202px;width:202px;padding-top:127px}"]})};export{T as LocationComponent};
